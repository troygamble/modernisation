import{n as l,o as y,q as d,v as g,w as u,x as _,y as o,z as A,A as w,B as E,C as v,D as m,E as b,F as T,H as F,G as x,I as D,J as p}from"./BKtW0jbn.js";class k{anchor;#s=new Map;#t=new Map;#e=new Map;#a=!0;constructor(s,t=!0){this.anchor=s,this.#a=t}#r=()=>{var s=l;if(this.#s.has(s)){var t=this.#s.get(s),e=this.#t.get(t);if(e)y(e);else{var r=this.#e.get(t);r&&(this.#t.set(t,r.effect),this.#e.delete(t),r.fragment.lastChild.remove(),this.anchor.before(r.fragment),e=r.effect)}for(const[i,a]of this.#s){if(this.#s.delete(i),i===s)break;const f=this.#e.get(a);f&&(d(f.effect),this.#e.delete(a))}for(const[i,a]of this.#t){if(i===t)continue;const f=()=>{if(Array.from(this.#s.values()).includes(i)){var h=document.createDocumentFragment();w(a,h),h.append(u()),this.#e.set(i,{effect:a,fragment:h})}else d(a);this.#t.delete(i)};this.#a||!e?g(a,f,!1):f()}}};#i=s=>{this.#s.delete(s);const t=Array.from(this.#s.values());for(const[e,r]of this.#e)t.includes(e)||(d(r.effect),this.#e.delete(e))};ensure(s,t){var e=l,r=E();if(t&&!this.#t.has(s)&&!this.#e.has(s))if(r){var i=document.createDocumentFragment(),a=u();i.append(a),this.#e.set(s,{effect:_(()=>t(a)),fragment:i})}else this.#t.set(s,_(()=>t(this.anchor)));if(this.#s.set(e,s),r){for(const[f,n]of this.#t)f===s?e.skipped_effects.delete(n):e.skipped_effects.add(n);for(const[f,n]of this.#e)f===s?e.skipped_effects.delete(n.effect):e.skipped_effects.add(n.effect);e.oncommit(this.#r),e.ondiscard(this.#i)}else o&&(this.anchor=A),this.#r()}}function R(c,s,t=!1){o&&m();var e=new k(c),r=t?b:0;function i(a,f){if(o){const h=T(c)===F;if(a===h){var n=x();D(n),e.anchor=n,p(!1),e.ensure(a,f),p(!0);return}}e.ensure(a,f)}v(()=>{var a=!1;s((f,n=!0)=>{a=!0,i(n,f)}),a||i(!1,null)},r)}function B(c,s,t){o&&m();var e=new k(c);v(()=>{var r=s()??null;e.ensure(r,r&&(i=>t(i,r)))},b)}export{k as B,B as c,R as i};
