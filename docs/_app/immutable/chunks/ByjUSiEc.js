import{n as u,o as A,q as d,v as T,w as l,x as _,y as o,z as g,A as E,B as w,C as v,D as k,E as m,F as M,H as S,G as F,I as x,J as p,K as B,L as D,b as R,M as C,S as L}from"./VEWuAR18.js";class y{anchor;#s=new Map;#t=new Map;#e=new Map;#a=!0;constructor(e,a=!0){this.anchor=e,this.#a=a}#r=()=>{var e=u;if(this.#s.has(e)){var a=this.#s.get(e),t=this.#t.get(a);if(t)A(t);else{var r=this.#e.get(a);r&&(this.#t.set(a,r.effect),this.#e.delete(a),r.fragment.lastChild.remove(),this.anchor.before(r.fragment),t=r.effect)}for(const[s,i]of this.#s){if(this.#s.delete(s),s===e)break;const c=this.#e.get(i);c&&(d(c.effect),this.#e.delete(i))}for(const[s,i]of this.#t){if(s===a)continue;const c=()=>{if(Array.from(this.#s.values()).includes(s)){var h=document.createDocumentFragment();E(i,h),h.append(l()),this.#e.set(s,{effect:i,fragment:h})}else d(i);this.#t.delete(s)};this.#a||!t?T(i,c,!1):c()}}};#i=e=>{this.#s.delete(e);const a=Array.from(this.#s.values());for(const[t,r]of this.#e)a.includes(t)||(d(r.effect),this.#e.delete(t))};ensure(e,a){var t=u,r=w();if(a&&!this.#t.has(e)&&!this.#e.has(e))if(r){var s=document.createDocumentFragment(),i=l();s.append(i),this.#e.set(e,{effect:_(()=>a(i)),fragment:s})}else this.#t.set(e,_(()=>a(this.anchor)));if(this.#s.set(t,e),r){for(const[c,n]of this.#t)c===e?t.skipped_effects.delete(n):t.skipped_effects.add(n);for(const[c,n]of this.#e)c===e?t.skipped_effects.delete(n.effect):t.skipped_effects.add(n.effect);t.oncommit(this.#r),t.ondiscard(this.#i)}else o&&(this.anchor=g),this.#r()}}function q(f,e,a=!1){o&&k();var t=new y(f),r=a?m:0;function s(i,c){if(o){const h=M(f)===S;if(i===h){var n=F();x(n),t.anchor=n,p(!1),t.ensure(i,c),p(!0);return}}t.ensure(i,c)}v(()=>{var i=!1;e((c,n=!0)=>{i=!0,s(n,c)}),i||s(!1,null)},r)}function H(f,e,a){o&&k();var t=new y(f);v(()=>{var r=e()??null;t.ensure(r,r&&(s=>a(s,r)))},m)}function b(f,e){return f===e||f?.[L]===e}function I(f={},e,a,t){return B(()=>{var r,s;return D(()=>{r=s,s=[],R(()=>{f!==a(...s)&&(e(f,...s),r&&b(a(...r),f)&&e(null,...r))})}),()=>{C(()=>{s&&b(a(...s),f)&&e(null,...s)})}}),f}export{y as B,I as b,H as c,q as i};
